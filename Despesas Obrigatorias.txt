let
    Fonte = Exchange.Contents("setor@orgao.gov.br"),
    Mail1 = Fonte{[Name="Mail"]}[Data],
    #"Linhas Filtradas" = Table.SelectRows(Mail1, each ([Folder Path] = "\TG_Orcamento\")),
    #"Linhas Classificadas" = Table.Sort(#"Linhas Filtradas",{{"DateTimeSent", Order.Descending}}),
    #"Linhas Filtradas3" = Table.SelectRows(#"Linhas Classificadas", each Text.Contains(Text.Lower([Subject]), "obrigat") = true),
    #"Linhas Filtradas1" = Table.SelectRows(#"Linhas Filtradas3", each [HasAttachments] = true),
    #"Attachments Expandido" = Table.ExpandTableColumn(#"Linhas Filtradas1", "Attachments", {"Name", "Extension", "IsInline", "Size", "ContentType", "Last Modified", "AttachmentContent"}, {"Attachments.Name", "Attachments.Extension", "Attachments.IsInline", "Attachments.Size", "Attachments.ContentType", "Attachments.Last Modified", "Attachments.AttachmentContent"}),
    #"Linhas Filtradas2" = Table.SelectRows(#"Attachments Expandido", each ([Attachments.Extension] = ".xlsx")),
    #"Attachments AttachmentContent" = #"Linhas Filtradas2"{0}[Attachments.AttachmentContent],
    #"Pasta de Trabalho Importada do Excel" = Excel.Workbook(#"Attachments AttachmentContent"),
    #"Abre conteudo" = #"Pasta de Trabalho Importada do Excel"{[Item="0. 2025. Despesas OBRIGATÓRIAS",Kind="Sheet"]}[Data],
    #"Linhas em Branco Removidas" = Table.SelectRows(#"Abre conteudo", each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))),
    #"Linhas Superiores Removidas1" = Table.Skip(#"Linhas em Branco Removidas",4),
    Personalizar1 = Table.ReplaceValue(#"Linhas Superiores Removidas1",null,0,Replacer.ReplaceValue,{"Column13","Column14","Column15"}),
    Personalizar4 = Table.SelectRows(Personalizar1, each [Column3] <> "Total"),
    Personalizar5 = Table.SelectRows(Personalizar4, each [Column1] <> "Total"),
    #"Colunas Removidas" = Table.RemoveColumns(Personalizar5,{"Column3","Column4","Column5","Column6","Column7"}),
    #"Preenchido Abaixo" = Table.FillDown(#"Colunas Removidas",{"Column1","Column2","Column8","Column9","Column10","Column11","Column12"}),
    #"Linhas Superiores Removidas2" = Table.Skip(#"Preenchido Abaixo",1),
    #"Colunas Mescladas" = Table.CombineColumns(#"Linhas Superiores Removidas2",{"Column1", "Column2"},Combiner.CombineTextByDelimiter(" ", QuoteStyle.None),"Acao Governo"),
    #"Colunas Mescladas1" = Table.CombineColumns(#"Colunas Mescladas",{"Column8", "Column9"},Combiner.CombineTextByDelimiter(" ", QuoteStyle.None),"Plano Orcamentario"),
    #"Colunas Mescladas2" = Table.CombineColumns(#"Colunas Mescladas1",{"Column11", "Column12"},Combiner.CombineTextByDelimiter(" ", QuoteStyle.None),"Natureza Despesa"),
    #"Cabeçalhos Promovidos" = Table.PromoteHeaders(#"Colunas Mescladas2", [PromoteAllScalars=true]),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Cabeçalhos Promovidos",{{" ", "Plano Orcamentario"}}),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"Colunas Renomeadas",{{"DESPESAS EMPENHADAS (CONTROLE EMPENHO)", Currency.Type}, {"DESPESAS LIQUIDADAS (CONTROLE EMPENHO)", Currency.Type}, {"DESPESAS PAGAS (CONTROLE EMPENHO)", Currency.Type}}),
    Personalizar2 = Table.AddColumn(#"Tipo Alterado", "Saldo", each [#"DESPESAS EMPENHADAS (CONTROLE EMPENHO)"] - [#"DESPESAS LIQUIDADAS (CONTROLE EMPENHO)"]),
    Personalizar3 = Table.TransformColumnTypes(#"Personalizar2",{{"Saldo", Currency.Type}})
in
    Personalizar3