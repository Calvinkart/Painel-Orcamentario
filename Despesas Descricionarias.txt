let
    Fonte = Exchange.Contents("setor@orgao.gov.br"),
    Mail1 = Fonte{[Name="Mail"]}[Data],
    #"Linhas Filtradas" = Table.SelectRows(Mail1, each ([Folder Path] = "\TG_Orcamento\")),
    #"Linhas Classificadas" = Table.Sort(#"Linhas Filtradas",{{"DateTimeSent", Order.Descending}}),
    #"Linhas Filtradas3" = Table.SelectRows(#"Linhas Classificadas", each Text.Contains(Text.Lower([Subject]), "despesas discricion") = true),
    #"Linhas Filtradas1" = Table.SelectRows(#"Linhas Filtradas3", each [HasAttachments] = true),
    #"Attachments Expandido" = Table.ExpandTableColumn(#"Linhas Filtradas1", "Attachments", {"Name", "Extension", "IsInline", "Size", "ContentType", "Last Modified", "AttachmentContent"}, {"Attachments.Name", "Attachments.Extension", "Attachments.IsInline", "Attachments.Size", "Attachments.ContentType", "Attachments.Last Modified", "Attachments.AttachmentContent"}),
    #"Linhas Filtradas2" = Table.SelectRows(#"Attachments Expandido", each ([Attachments.Extension] = ".xlsx")),
    #"Attachments AttachmentContent" = #"Linhas Filtradas2"{0}[Attachments.AttachmentContent],
    #"Pasta de Trabalho Importada do Excel" = Excel.Workbook(#"Attachments AttachmentContent"),
    #"Abre aba" = #"Pasta de Trabalho Importada do Excel"{[Item="0. 2025 - Despesas Discricionár",Kind="Sheet"]}[Data],
    #"Linhas Superiores Removidas1" = Table.Skip(#"Abre aba",6),
    Personalizar3 = Table.FillDown(#"Linhas Superiores Removidas1",{"Column1","Column2","Column3","Column4","Column5","Column6","Column7","Column8","Column9","Column10","Column11","Column12"}),
    #"Linhas Filtradas4" = Table.SelectRows(Personalizar3, each [Column3] <> "Total"),
    #"Colunas Mescladas1" = Table.CombineColumns(#"Linhas Filtradas4",{"Column1", "Column2"},Combiner.CombineTextByDelimiter(" ", QuoteStyle.None),"Acao Governo"),
    Personalizar2 = Table.ReplaceValue(#"Colunas Mescladas1",null,0,Replacer.ReplaceValue,{"Column14", "Column15"}),
    #"Colunas Removidas" = Table.RemoveColumns(Personalizar2,{"Column3","Column4","Column5", "Column6","Column7"}),
    #"Colunas Mescladas" = Table.CombineColumns(#"Colunas Removidas",{"Column8", "Column9"},Combiner.CombineTextByDelimiter(" ", QuoteStyle.None),"Plano Orcamentario"),
    #"Colunas Mescladas2" = Table.CombineColumns(#"Colunas Mescladas",{"Column11", "Column12"},Combiner.CombineTextByDelimiter(" ", QuoteStyle.None),"Natureza Despesa "),
    #"Linhas Superiores Removidas" = Table.Skip(#"Colunas Mescladas2",1),
    #"Cabeçalhos Promovidos" = Table.PromoteHeaders(#"Linhas Superiores Removidas", [PromoteAllScalars=true]),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Cabeçalhos Promovidos",{{" ", "Plano Orcamentario"}}),
    #"Índice Adicionado" = Table.AddIndexColumn(#"Colunas Renomeadas", "Índice", 0, 0, Int64.Type),
    #"Colunas Renomeadas1" = Table.RenameColumns(#"Índice Adicionado",{{"Índice", "RESTOS A PAGAR A PAGAR (PROC E N PROC)"}}),
    #"Índice Adicionado1" = Table.AddIndexColumn(#"Colunas Renomeadas1", "Índice", 0, 0, Int64.Type),
    #"Colunas Renomeadas2" = Table.RenameColumns(#"Índice Adicionado1",{{"Índice", "RESTOS A PAGAR PAGOS (PROC E N PROC)"}}),
    Personalizar1 = Table.TransformColumnTypes(#"Colunas Renomeadas2",{{"DESPESAS EMPENHADAS (CONTROLE EMPENHO)", Currency.Type}, {"DESPESAS LIQUIDADAS (CONTROLE EMPENHO)", Currency.Type}, {"DESPESAS PAGAS (CONTROLE EMPENHO)", Currency.Type},{"RESTOS A PAGAR A PAGAR (PROC E N PROC)", Currency.Type}, {"RESTOS A PAGAR PAGOS (PROC E N PROC)", Currency.Type}}),
    #"Colunas Renomeadas3" = Table.RenameColumns(Personalizar1,{{"Ação Governo ", "Ação Governo"}})
in
    #"Colunas Renomeadas3"